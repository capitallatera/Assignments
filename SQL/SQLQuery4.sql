-- GROUP BY, ORDER BY

USE DEMO
CREATE TABLE EMP_1 
(EMPID CHAR(7),																		--PRIMARY KEY						DONE
NAME VARCHAR(25) NOT NULL,															--NOT NULL							DONE	
ADDR VARCHAR(30) CHECK (ADDR NOT LIKE ('%UTTAM NAGAR%')),								--NO EMPLOYEE FROM UTTAM NAGAR		DONE
CITY VARCHAR(15) CHECK (CITY IN ('DEL','GGN','FBD','NOIDA')),						--CHECK 'DEL','GGN','FBD','NOIDA',	DONE
PHNO CHAR(10) UNIQUE,																--UNIQUE							DONE			
EMAIL VARCHAR(40) CHECK (EMAIL LIKE '%GMAIL%' OR EMAIL LIKE '%YAHOO%'),								--SHOULD BE ON GMAIL/YAHOO DOMAIN	DONE
DOB DATE CHECK (DOB >='01-JAN-1990'),												--CHECK DOB <='01-JAN-1990'			DONE
PRIMARY KEY (EMPID)
);

DROP TABLE EMP_1;
DROP TABLE EMP_SALARY;

CREATE TABLE EMP_SALARY(
EMPID CHAR(7) REFERENCES EMP_1 (EMPID),
DEPT VARCHAR(10) CHECK (DEPT IN ('HR','MIS','OPS','IT','ADMIN','TEMP')),
DESI VARCHAR(10) CHECK (DESI IN ('ASSO','MGR','VP','DIR')),
SAL INT CHECK (SAL >=20000),
DOJ DATE
);

--INSERT RECORDS ON EMP_1 AND EMP_SALARY

SELECT * FROM EMP_1;

INSERT INTO EMP_1 VALUES('E0001','RAJAN SHARMA','91 GURNET ROAD, BRUNSWIK','DEL','7340977599','CAPITALLATERA@GMAIL.COM','11-NOV-1993');
INSERT INTO EMP_1 VALUES ('E0002','MOHIT MEHRA','41 SHERMAN ROAD, ST. JOHNBURY','GGN','9915132869','PSTUART@YAHOO.COM','15-AUG-1992');
INSERT INTO EMP_1 VALUES('E0003','HENRY LAWSON','200 MACINTYRE ROAD','FBD','9965231478','HENRY.L@GMAIL.COM','31-MAR-1990');
INSERT INTO EMP_1 VALUES('E0004','MARIE MURRAY','11 HUNTERS TRL','NOIDA','9856324175','MARIE.MURRAY@GMAIL.COM','12-DEC-1998');
INSERT INTO EMP_1 VALUES('E0005','JACK PRINCE','45 THOMAS JOHNSON DRIVE','DEL','9768532145','JACKPRC@GMAIL.COM','03-MAR-1996');
INSERT INTO EMP_1 VALUES('E0006','KATE LEE','382 SEVEN STARS ROAD','GGN','9563214786','KATE-LEE@GMAIL.COM','04-APR-1994');
INSERT INTO EMP_1 VALUES('E0007','EMILY STEVEN','1228 BRANDON DRIVE','NOIDA','9563314786','EMILY.STEVENS@HYAHOO.COM','05-MAY-1996');
INSERT INTO EMP_1 VALUES('E0008','JOLLY TURING','3579 HIGHWAY 17,MURRELLS INLET','FBD','9465231785','JOLLYTURING@GMAIL.COM','05-JUN-2000');
INSERT INTO EMP_1 VALUES('E0009','HENRY LAWSON','1228 BRANDON DRIVE','DEL','9236541789','MADMAHAVIRA@YAHOO.COM','30-DEC-1990');
INSERT INTO EMP_1 VALUES('E0010','MAD MAHAVIRA','200 MACINTYRE ROAD','GGN','9136285479','GOOFYGOLDWASSER@GMAIL.COM','12-FEB-1991');



INSERT INTO EMP_SALARY VALUES ('E0001','MIS','MGR','20000','01-JAN-2020');
INSERT INTO EMP_SALARY VALUES ('E0002','OPS','ASSO','22000','015-DEC-2018');
INSERT INTO EMP_SALARY VALUES ('E0003','HR','VP','21000','19-OCT-2019');
INSERT INTO EMP_SALARY VALUES ('E0004','IT','DIR','24000','04-SEP-2018');
INSERT INTO EMP_SALARY VALUES ('E0005','ADMIN','VP','25000','18-NOV-2019');
INSERT INTO EMP_SALARY VALUES ('E0006','TEMP','ASSO','26000','17-APR-2017');
INSERT INTO EMP_SALARY VALUES ('E0007','MIS','VP','27000','20-JUN-2018');

SELECT * FROM EMP_1;
SELECT * FROM EMP_SALARY;

--CITY WISE COUNT OF EMPLOYEES ARRANGED IN DESCENDING ORDER
SELECT CITY, COUNT(EMPID) AS COUNT_EMP FROM EMP_1
GROUP BY CITY
ORDER BY  COUNT_EMP DESC;

--DETAILS OF THE EMPLOYEES WHO DOES NOT HAVE AN ACCOUNT ON YAHOO DOMAAIN
SELECT * FROM EMP_1
WHERE EMAIL NOT LIKE '%YAHOO%';

SELECT * FROM EMP_SALARY;

--DESIGNATION WISE TOTAL COST AND NUMBER OF MEMBERS ARRANGED IN DESCENDING ORDER OF THE TOTAL COST
SELECT DESI, SUM(SAL) AS TOTAL_COST, COUNT(EMPID) AS NO_OF_MEMBERS FROM EMP_SALARY
GROUP BY DESI
ORDER BY TOTAL_COST DESC;


