USE LEARN;

--ASSIGNMENT 7

--CREATE A FUNCTION CALC TO PERFORM THE SPECIFIED OPERATION ON THE GIVEN TWO NUMBERS.

CREATE FUNCTION CALC(@A AS INT, @B AS INT)
RETURNS INT
AS
BEGIN
		DECLARE @R AS INT;
		SET @R =@A+@B;
		RETURN @R;
END;

SELECT DBO.CALC(2,3);

-- FUNCTION TO GENERATE THE EMAIL ID BY ACCEPTING NAME & EID, EMAIL SHOULD CONTAIN 
-- 1ST CHARATER OF 1ST NAME, 1ST CHARACTER OF LAST NAME, LAST 3 DIGIT OF EMP ID 
-- FOLLOWED BY @RCG.COM;
USE DEMO;

SELECT * FROM EMP_1;
SELECT * FROM EMP_SAL;

DROP FUNCTION FN;

CREATE FUNCTION FN(@NAME VARCHAR(50),@EID AS CHAR(5))
RETURNS VARCHAR(50)
AS 
BEGIN
		DECLARE @R AS VARCHAR(50);
		SET @R=CONCAT(LEFT(LEFT(@NAME,CHARINDEX(' ',@NAME)),1),LEFT(RIGHT(@NAME, CHARINDEX(' ',@NAME)),1),SUBSTRING(@EID,3,3),'RCG.COM')
		RETURN @R;
END;

SELECT DBO.FN('ANIL SARKAR','E0003');


-- FUNCTION TO RETURN EID, NAME, DESI, DEPT, SALARY OF THE EMPLOYEES OF A SPECIFIED DEPARTMENT/CITY.
DROP FUNCTION FUN;

CREATE FUNCTION FUN(@CTY AS CHAR(5))
RETURNS TABLE 
AS 
RETURN(
		SELECT EMP_1.EMPID,NAME,DESI, DEPT, SALARY FROM EMP_1 
		INNER JOIN EMP_SAL 
		ON EMP_1.EMPID=EMP_SAL.EID
		WHERE CITY=@CTY
);
SELECT TOP 5 CITY FROM EMP_1;
SELECT * FROM DBO.FUN('FBD')

--FUNCTION TO DISPLAY THE NAME, DEPT, DESI CITY OF THE EMPLOYEES WHO HAVE THE BIRTHDAY IN THE CURRENT MONTH

DROP FUNCTION CURR_BIRTH;

CREATE FUNCTION CURR_BIRTH()
RETURNS TABLE
AS 
RETURN(
		SELECT EMP_1.NAME,DEPT,DESI,CITY FROM EMP_1
		INNER JOIN EMP_SAL
		ON EMP_1.EMPID=EMP_SAL.EID
		WHERE MONTH(DOB)=MONTH(GETDATE())-1  --REMOVE THE "-1"
);

SELECT * FROM DBO.CURR_BIRTH();

--FUNCTION TO DISPLAY THE NAME, DEPT AND DOJ OF EMPLOYEES WHO HAVE COMPLETED 5  YEARS IN THE COMPANY
DROP FUNCTION COUNT_YEARS;

CREATE FUNCTION COUNT_YEARS(@VALUE AS INT)
RETURNS TABLE 
AS 
RETURN(
		SELECT EMP_1.NAME,DEPT,DOJ FROM EMP_1
		INNER JOIN EMP_SAL 
		ON EMP_1.EMPID=EMP_SAL.EID
		WHERE YEAR(GETDATE())-YEAR(DOJ)=@VALUE
);

SELECT * FROM DBO.COUNT_YEARS(2);


















































































